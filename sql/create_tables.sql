-- Trino DDL for Premier League Football Statistics
-- Auto-generated from actual Parquet schema
-- Execute via Trino CLI or Python trino client

-- Create schema
CREATE SCHEMA IF NOT EXISTS hive.premier_league
WITH (location = 'hdfs://namenode:8020/data/premier_league');

-- =====================================
-- FIELD PLAYERS TABLE
-- =====================================

DROP TABLE IF EXISTS hive.premier_league.field_players;

-- Field Players: 179 columns
CREATE TABLE IF NOT EXISTS hive.premier_league.field_players (
    season VARCHAR,
    age BIGINT,
    squad VARCHAR,
    country VARCHAR,
    competition VARCHAR,
    performance_gls DOUBLE,
    performance_ast DOUBLE,
    performance_goals_plus_assists DOUBLE,
    performance_goals_minus_penalties DOUBLE,
    performance_pk DOUBLE,
    performance_pkatt DOUBLE,
    performance_crdy DOUBLE,
    performance_crdr DOUBLE,
    expected_xg DOUBLE,
    expected_npxg DOUBLE,
    expected_xag DOUBLE,
    expected_npxg_plus_xag DOUBLE,
    progression_prgc DOUBLE,
    progression_prgp DOUBLE,
    progression_prgr DOUBLE,
    per_90_gls DOUBLE,
    per_90_ast DOUBLE,
    per_90_goals_plus_assists DOUBLE,
    per_90_goals_minus_penalties DOUBLE,
    per_90_goals_plus_assists_minus_pk DOUBLE,
    per_90_xg DOUBLE,
    per_90_xag DOUBLE,
    per_90_xg_plus_xag DOUBLE,
    per_90_npxg DOUBLE,
    per_90_npxg_plus_xag DOUBLE,
    standard_gls_sh DOUBLE,
    standard_sh_sh DOUBLE,
    standard_sot_sh DOUBLE,
    standard_sot_pct_sh DOUBLE,
    standard_sh_per_90_sh DOUBLE,
    standard_sot_per_90_sh DOUBLE,
    standard_g_per_sh_sh DOUBLE,
    standard_g_per_sot_sh DOUBLE,
    standard_dist_sh DOUBLE,
    standard_fk_sh DOUBLE,
    standard_pk_sh DOUBLE,
    standard_pkatt_sh DOUBLE,
    expected_xg_sh DOUBLE,
    expected_npxg_sh DOUBLE,
    expected_npxg_per_sh_sh DOUBLE,
    expected_g_minus_xg_sh DOUBLE,
    "expected_np:g_minus_xg_sh" DOUBLE,
    total_cmp_pass DOUBLE,
    total_att_pass DOUBLE,
    total_cmp_pct_pass DOUBLE,
    total_totdist_pass DOUBLE,
    total_prgdist_pass DOUBLE,
    short_cmp_pass DOUBLE,
    short_att_pass DOUBLE,
    short_cmp_pct_pass DOUBLE,
    medium_cmp_pass DOUBLE,
    medium_att_pass DOUBLE,
    medium_cmp_pct_pass DOUBLE,
    long_cmp_pass DOUBLE,
    long_att_pass DOUBLE,
    long_cmp_pct_pass DOUBLE,
    ast_pass DOUBLE,
    xag_pass DOUBLE,
    expected_xa_pass DOUBLE,
    expected_a_minus_xag_pass DOUBLE,
    kp_pass DOUBLE,
    "1_per_3_pass" DOUBLE,
    ppa_pass DOUBLE,
    crspa_pass DOUBLE,
    prgp_pass DOUBLE,
    tackles_tkl_def DOUBLE,
    tackles_tklw_def DOUBLE,
    tackles_def_third_def DOUBLE,
    tackles_mid_third_def DOUBLE,
    tackles_att_third_def DOUBLE,
    challenges_tkl_def DOUBLE,
    challenges_att_def DOUBLE,
    challenges_tkl_pct_def DOUBLE,
    challenges_lost_def DOUBLE,
    blocks_blocks_def DOUBLE,
    blocks_sh_def DOUBLE,
    blocks_pass_def DOUBLE,
    int_def DOUBLE,
    tkl_plus_int_def DOUBLE,
    clr_def DOUBLE,
    err_def DOUBLE,
    mp BIGINT,
    minutes DOUBLE,
    minutes_per_match DOUBLE,
    minutes_pct DOUBLE,
    minutes_90 DOUBLE,
    starts_total BIGINT,
    minutes_per_start DOUBLE,
    matches_completed DOUBLE,
    subs_on BIGINT,
    minutes_per_sub DOUBLE,
    subs_unused DOUBLE,
    team_points_per_match DOUBLE,
    team_goals_for DOUBLE,
    team_goals_against DOUBLE,
    team_goal_diff DOUBLE,
    team_goal_diff_per90 DOUBLE,
    team_on_off DOUBLE,
    team_xg_for DOUBLE,
    team_xg_against DOUBLE,
    team_xg_diff DOUBLE,
    team_xg_diff_per90 DOUBLE,
    team_xg_on_off DOUBLE,
    sca_sca_gca DOUBLE,
    sca_sca90_gca DOUBLE,
    sca_types_passlive_gca DOUBLE,
    sca_types_passdead_gca DOUBLE,
    sca_types_to_gca DOUBLE,
    sca_types_sh_gca DOUBLE,
    sca_types_fld_gca DOUBLE,
    sca_types_def_gca DOUBLE,
    gca_gca_gca DOUBLE,
    gca_gca90_gca DOUBLE,
    gca_types_passlive_gca DOUBLE,
    gca_types_passdead_gca DOUBLE,
    gca_types_to_gca DOUBLE,
    gca_types_sh_gca DOUBLE,
    gca_types_fld_gca DOUBLE,
    gca_types_def_gca DOUBLE,
    touches_touches_poss DOUBLE,
    touches_def_penalty_area_poss DOUBLE,
    touches_def_third_poss DOUBLE,
    touches_mid_third_poss DOUBLE,
    touches_att_third_poss DOUBLE,
    touches_att_penalty_area_poss DOUBLE,
    touches_live_poss DOUBLE,
    takeons_att_poss DOUBLE,
    takeons_succ_poss DOUBLE,
    takeons_succ_pct_poss DOUBLE,
    takeons_tkld_poss DOUBLE,
    takeons_tkld_pct_poss DOUBLE,
    carries_carries_poss DOUBLE,
    carries_totdist_poss DOUBLE,
    carries_prgdist_poss DOUBLE,
    carries_prgc_poss DOUBLE,
    carries_1_per_3_poss DOUBLE,
    carries_cpa_poss DOUBLE,
    carries_mis_poss DOUBLE,
    carries_dis_poss DOUBLE,
    receiving_rec_poss DOUBLE,
    receiving_prgr_poss DOUBLE,
    performance_crdy_misc DOUBLE,
    performance_crdr_misc DOUBLE,
    performance_2crdy_misc DOUBLE,
    performance_fls_misc DOUBLE,
    performance_fld_misc DOUBLE,
    performance_off_misc DOUBLE,
    performance_crs_misc DOUBLE,
    performance_int_misc DOUBLE,
    performance_tklw_misc DOUBLE,
    performance_pkwon_misc DOUBLE,
    performance_pkcon_misc DOUBLE,
    performance_og_misc DOUBLE,
    performance_recov_misc DOUBLE,
    aerial_duels_won_misc DOUBLE,
    aerial_duels_lost_misc DOUBLE,
    aerial_duels_won_pct_misc DOUBLE,
    att_pt DOUBLE,
    pass_types_live_pt DOUBLE,
    pass_types_dead_pt DOUBLE,
    pass_types_fk_pt DOUBLE,
    pass_types_tb_pt DOUBLE,
    pass_types_sw_pt DOUBLE,
    pass_types_crs_pt DOUBLE,
    pass_types_ti_pt DOUBLE,
    pass_types_ck_pt DOUBLE,
    corner_kicks_in_pt DOUBLE,
    corner_kicks_out_pt DOUBLE,
    corner_kicks_str_pt DOUBLE,
    outcomes_cmp_pt DOUBLE,
    outcomes_off_pt DOUBLE,
    outcomes_blocks_pt DOUBLE,
    player_name VARCHAR,
    team VARCHAR
)
WITH (
    format = 'PARQUET',
    partitioned_by = ARRAY['team'],
    external_location = 'hdfs://namenode:8020/data/premier_league/field_players'
);

-- =====================================
-- GOALKEEPERS TABLE
-- =====================================

DROP TABLE IF EXISTS hive.premier_league.goalkeepers;

-- Goalkeepers: 258 columns
CREATE TABLE IF NOT EXISTS hive.premier_league.goalkeepers (
    season VARCHAR,
    age DOUBLE,
    squad VARCHAR,
    country VARCHAR,
    competition VARCHAR,
    performance_ga DOUBLE,
    performance_ga90 DOUBLE,
    performance_sota DOUBLE,
    performance_saves DOUBLE,
    performance_save_pct DOUBLE,
    performance_w DOUBLE,
    performance_d DOUBLE,
    performance_l DOUBLE,
    performance_cs DOUBLE,
    performance_cs_pct DOUBLE,
    penalty_kicks_pkatt DOUBLE,
    penalty_kicks_pka DOUBLE,
    penalty_kicks_pksv DOUBLE,
    penalty_kicks_pkm DOUBLE,
    penalty_kicks_save_pct DOUBLE,
    goals_ga DOUBLE,
    goals_pka DOUBLE,
    goals_fk DOUBLE,
    goals_ck DOUBLE,
    goals_og DOUBLE,
    expected_psxg DOUBLE,
    expected_psxg_per_sot DOUBLE,
    expected_psxg_plus_per_minus DOUBLE,
    expected_per_90 DOUBLE,
    launched_cmp DOUBLE,
    launched_att DOUBLE,
    launched_cmp_pct DOUBLE,
    passes_att_gk DOUBLE,
    passes_thr DOUBLE,
    passes_launch_pct DOUBLE,
    passes_avglen DOUBLE,
    goal_kicks_att DOUBLE,
    goal_kicks_launch_pct DOUBLE,
    goal_kicks_avglen DOUBLE,
    crosses_opp DOUBLE,
    crosses_stp DOUBLE,
    crosses_stp_pct DOUBLE,
    sweeper_num_opa DOUBLE,
    sweeper_num_opa_per_90 DOUBLE,
    sweeper_avgdist DOUBLE,
    performance_gls DOUBLE,
    performance_ast DOUBLE,
    performance_goals_plus_assists DOUBLE,
    performance_goals_minus_penalties DOUBLE,
    performance_pk DOUBLE,
    performance_pkatt DOUBLE,
    performance_crdy DOUBLE,
    performance_crdr DOUBLE,
    expected_xg DOUBLE,
    expected_npxg DOUBLE,
    expected_xag DOUBLE,
    expected_npxg_plus_xag DOUBLE,
    progression_prgc DOUBLE,
    progression_prgp DOUBLE,
    progression_prgr DOUBLE,
    per_90_gls DOUBLE,
    per_90_ast DOUBLE,
    per_90_goals_plus_assists DOUBLE,
    per_90_goals_minus_penalties DOUBLE,
    per_90_goals_plus_assists_minus_pk DOUBLE,
    per_90_xg DOUBLE,
    per_90_xag DOUBLE,
    per_90_xg_plus_xag DOUBLE,
    per_90_npxg DOUBLE,
    per_90_npxg_plus_xag DOUBLE,
    standard_gls_shooting DOUBLE,
    standard_sh_shooting DOUBLE,
    standard_sot_shooting DOUBLE,
    standard_sot_pct_shooting DOUBLE,
    standard_sh_per_90_shooting DOUBLE,
    standard_sot_per_90_shooting DOUBLE,
    standard_g_per_sh_shooting DOUBLE,
    standard_g_per_sot_shooting DOUBLE,
    standard_dist_shooting DOUBLE,
    standard_fk_shooting DOUBLE,
    standard_pk_shooting DOUBLE,
    standard_pkatt_shooting DOUBLE,
    expected_xg_shooting DOUBLE,
    expected_npxg_shooting DOUBLE,
    expected_npxg_per_sh_shooting DOUBLE,
    expected_g_minus_xg_shooting DOUBLE,
    "expected_np:g_minus_xg_shooting" DOUBLE,
    total_cmp_passing DOUBLE,
    total_att_passing DOUBLE,
    total_cmp_pct_passing DOUBLE,
    total_totdist_passing DOUBLE,
    total_prgdist_passing DOUBLE,
    short_cmp_passing DOUBLE,
    short_att_passing DOUBLE,
    short_cmp_pct_passing DOUBLE,
    medium_cmp_passing DOUBLE,
    medium_att_passing DOUBLE,
    medium_cmp_pct_passing DOUBLE,
    long_cmp_passing DOUBLE,
    long_att_passing DOUBLE,
    long_cmp_pct_passing DOUBLE,
    ast_passing DOUBLE,
    xag_passing DOUBLE,
    expected_xa_passing DOUBLE,
    expected_a_minus_xag_passing DOUBLE,
    kp_passing DOUBLE,
    "1_per_3_passing" DOUBLE,
    ppa_passing DOUBLE,
    crspa_passing DOUBLE,
    prgp_passing DOUBLE,
    att_pass_types DOUBLE,
    pass_types_live_pass_types DOUBLE,
    pass_types_dead_pass_types DOUBLE,
    pass_types_fk_pass_types DOUBLE,
    pass_types_tb_pass_types DOUBLE,
    pass_types_sw_pass_types DOUBLE,
    pass_types_crs_pass_types DOUBLE,
    pass_types_ti_pass_types DOUBLE,
    pass_types_ck_pass_types DOUBLE,
    corner_kicks_in_pass_types DOUBLE,
    corner_kicks_out_pass_types DOUBLE,
    corner_kicks_str_pass_types DOUBLE,
    outcomes_cmp_pass_types DOUBLE,
    outcomes_off_pass_types DOUBLE,
    outcomes_blocks_pass_types DOUBLE,
    sca_sca_gca DOUBLE,
    sca_sca90_gca DOUBLE,
    sca_types_passlive_gca DOUBLE,
    sca_types_passdead_gca DOUBLE,
    sca_types_to_gca DOUBLE,
    sca_types_sh_gca DOUBLE,
    sca_types_fld_gca DOUBLE,
    sca_types_def_gca DOUBLE,
    gca_gca_gca DOUBLE,
    gca_gca90_gca DOUBLE,
    gca_types_passlive_gca DOUBLE,
    gca_types_passdead_gca DOUBLE,
    gca_types_to_gca DOUBLE,
    gca_types_sh_gca DOUBLE,
    gca_types_fld_gca DOUBLE,
    gca_types_def_gca DOUBLE,
    tackles_tkl_defense DOUBLE,
    tackles_tklw_defense DOUBLE,
    tackles_def_third_defense DOUBLE,
    tackles_mid_third_defense DOUBLE,
    tackles_att_third_defense DOUBLE,
    challenges_tkl_defense DOUBLE,
    challenges_att_defense DOUBLE,
    challenges_tkl_pct_defense DOUBLE,
    challenges_lost_defense DOUBLE,
    blocks_blocks_defense DOUBLE,
    blocks_sh_defense DOUBLE,
    blocks_pass_defense DOUBLE,
    int_defense DOUBLE,
    tkl_plus_int_defense DOUBLE,
    clr_defense DOUBLE,
    err_defense DOUBLE,
    touches_touches_possession DOUBLE,
    touches_def_penalty_area_possession DOUBLE,
    touches_def_third_possession DOUBLE,
    touches_mid_third_possession DOUBLE,
    touches_att_third_possession DOUBLE,
    touches_att_penalty_area_possession DOUBLE,
    touches_live_possession DOUBLE,
    takeons_att_possession DOUBLE,
    takeons_succ_possession DOUBLE,
    takeons_succ_pct_possession DOUBLE,
    takeons_tkld_possession DOUBLE,
    takeons_tkld_pct_possession DOUBLE,
    carries_carries_possession DOUBLE,
    carries_totdist_possession DOUBLE,
    carries_prgdist_possession DOUBLE,
    carries_prgc_possession DOUBLE,
    carries_1_per_3_possession DOUBLE,
    carries_cpa_possession DOUBLE,
    carries_mis_possession DOUBLE,
    carries_dis_possession DOUBLE,
    receiving_rec_possession DOUBLE,
    receiving_prgr_possession DOUBLE,
    matches_played DOUBLE,
    playing_time_min_playing_time DOUBLE,
    playing_time_minutes_per_match DOUBLE,
    playing_time_minutes_pct_playing_time DOUBLE,
    playing_time_90s_playing_time DOUBLE,
    starts_starts_playing_time DOUBLE,
    starts_minutes_per_start_playing_time DOUBLE,
    starts_compl DOUBLE,
    subs_subs_playing_time DOUBLE,
    subs_minutes_per_sub_playing_time DOUBLE,
    subs_unsub_playing_time DOUBLE,
    team_success_ppm_playing_time DOUBLE,
    team_success_ong_playing_time DOUBLE,
    team_success_onga_playing_time DOUBLE,
    team_success_plus_per_minus_playing_time DOUBLE,
    team_success_plus_per_minus_90_playing_time DOUBLE,
    team_success_on_minus_off_playing_time DOUBLE,
    team_success_xg_onxg_playing_time DOUBLE,
    team_success_xg_onxga_playing_time DOUBLE,
    team_success_xg_xg_plus_per_minus_playing_time DOUBLE,
    team_success_xg_xg_plus_per_minus_90_playing_time DOUBLE,
    team_success_xg_on_minus_off_playing_time DOUBLE,
    performance_crdy_miscellaneous DOUBLE,
    performance_crdr_miscellaneous DOUBLE,
    performance_2crdy_miscellaneous DOUBLE,
    performance_fls_miscellaneous DOUBLE,
    performance_fld_miscellaneous DOUBLE,
    performance_off_miscellaneous DOUBLE,
    performance_crs_miscellaneous DOUBLE,
    performance_int_miscellaneous DOUBLE,
    performance_tklw_miscellaneous DOUBLE,
    performance_pkwon_miscellaneous DOUBLE,
    performance_pkcon_miscellaneous DOUBLE,
    performance_og_miscellaneous DOUBLE,
    performance_recov_miscellaneous DOUBLE,
    aerial_duels_won_miscellaneous DOUBLE,
    aerial_duels_lost_miscellaneous DOUBLE,
    aerial_duels_won_pct_miscellaneous DOUBLE,
    player_name VARCHAR,
    goals_ga_shooting DOUBLE,
    goals_pka_shooting DOUBLE,
    goals_fk_shooting DOUBLE,
    goals_ck_shooting DOUBLE,
    goals_og_shooting DOUBLE,
    expected_psxg_shooting DOUBLE,
    expected_psxg_per_sot_shooting DOUBLE,
    expected_psxg_plus_per_minus_shooting DOUBLE,
    expected_per_90_shooting DOUBLE,
    launched_cmp_shooting DOUBLE,
    launched_att_shooting DOUBLE,
    launched_cmp_pct_shooting DOUBLE,
    passes_att_gk_shooting DOUBLE,
    passes_thr_shooting DOUBLE,
    passes_launch_pct_shooting DOUBLE,
    passes_avglen_shooting DOUBLE,
    goal_kicks_att_shooting DOUBLE,
    goal_kicks_launch_pct_shooting DOUBLE,
    goal_kicks_avglen_shooting DOUBLE,
    crosses_opp_shooting DOUBLE,
    crosses_stp_shooting DOUBLE,
    crosses_stp_pct_shooting DOUBLE,
    sweeper_num_opa_shooting DOUBLE,
    sweeper_num_opa_per_90_shooting DOUBLE,
    sweeper_avgdist_shooting DOUBLE,
    playing_time_mp DOUBLE,
    performance_crdy_defense DOUBLE,
    performance_crdr_defense DOUBLE,
    performance_2crdy_defense DOUBLE,
    performance_fls_defense DOUBLE,
    performance_fld_defense DOUBLE,
    performance_off_defense DOUBLE,
    performance_crs_defense DOUBLE,
    performance_int_defense DOUBLE,
    performance_tklw_defense DOUBLE,
    performance_pkwon_defense DOUBLE,
    performance_pkcon_defense DOUBLE,
    performance_og_defense DOUBLE,
    lgrank VARCHAR,
    team VARCHAR
)
WITH (
    format = 'PARQUET',
    partitioned_by = ARRAY['team'],
    external_location = 'hdfs://namenode:8020/data/premier_league/goalkeepers'
);

-- =====================================
-- PARTITION SYNC (run after data upload)
-- =====================================

CALL system.sync_partition_metadata('premier_league', 'field_players', 'FULL');
CALL system.sync_partition_metadata('premier_league', 'goalkeepers', 'FULL');

-- =====================================
-- EXAMPLE QUERIES
-- =====================================

-- SELECT * FROM hive.premier_league.field_players WHERE team = 'arsenal' LIMIT 10;
-- SELECT player_name, performance_gls, performance_ast FROM hive.premier_league.field_players ORDER BY performance_gls DESC LIMIT 10;
-- SELECT team, SUM(performance_gls) as goals FROM hive.premier_league.field_players GROUP BY team ORDER BY goals DESC;